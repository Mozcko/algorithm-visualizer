---
// src/pages/[category]/[id].astro
import MainLayout from "../../layouts/Layout.astro";
import type { AlgorithmDefinition } from "../../algorithms/types";
import AlgorithmRunner from "../../components/AlgorithmRunner"; // Importa el nuevo componente

// 1. Generar rutas estáticas basadas en los archivos existentes
export async function getStaticPaths() {
  const algorithmsImport = import.meta.glob("../../algorithms/**/*.ts", {
    eager: true,
  });
  const algorithms = Object.values(algorithmsImport)
    .map((mod: any) => mod.default as AlgorithmDefinition)
    .filter((algo) => algo && algo.category);

  return algorithms.map((algo) => ({
    params: {
      category: algo.category.toLowerCase(),
      algorithm: algo.id,
    },
    props: { algorithm: algo },
  }));
}

// 2. Obtener los datos del algoritmo para esta página
interface Props {
  algorithm: AlgorithmDefinition;
}
const { algorithm } = Astro.props;
---

<MainLayout title={algorithm.name} currentAlgoId={algorithm.id}>
  <header class="bg-slate-900 border-b border-slate-700 p-4 sm:p-6 shadow-md z-10">
    <div class="flex justify-between items-center">
      <div>
        <h1 class="text-xl sm:text-2xl font-bold text-white">{algorithm.name}</h1>
        <p class="text-slate-400 text-xs sm:text-sm mt-1">{algorithm.description}</p>
      </div>
    </div>
  </header>

  <div class="flex-1 p-2 sm:p-6 flex flex-col items-center bg-slate-950">
    <div class="w-full max-w-5xl">
      <AlgorithmRunner client:only="react" algorithmId={algorithm.id} />
    </div>
  </div>
</MainLayout>
